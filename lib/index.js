// Generated by CoffeeScript 1.6.2
var Runner, fs, m, path, vm, walk;

m = require('module');

fs = require('fs');

vm = require('vm');

path = require('path');

walk = require('walkdir');

Runner = require('./runner');

exports.run = function(options) {
  var emitter, k, matchers, v;

  ['factories', 'spectacular'].forEach(function(file) {
    var filename, src;

    filename = path.resolve(__dirname, "" + file + ".js");
    src = fs.readFileSync(filename);
    return vm.runInThisContext(src, filename);
  });
  matchers = require('./matchers');
  for (k in matchers) {
    v = matchers[k];
    global[k] = v;
  }
  if (!options.noMatchers) {
    emitter = walk(options.matchersRoot);
    emitter.on('file', function(path, stat) {
      var _results;

      matchers = require(path);
      _results = [];
      for (k in matchers) {
        v = matchers[k];
        _results.push(global[k] = v);
      }
      return _results;
    });
  }
  return new Runner(rootExampleGroup, options).run();
};
